# chapter 05-1 DNS와 자원
<br/>
<br/>

## 도메인 네임과 네임 서버

- 네트워크 상의 어떤 호스트를 특정하기 위해 ip주소를 사용한다. 하지만 ip주소만 사용한다면 통신하고자 하는 모든 호스트의 ip주소를 기억하고 있어야 하며, 또한 호스트의 ip주소는 언제든지 바뀔 수 있기 때문에 ip 주소만 사용하기에는 번거롭다.
- 그래서 일반적으로 사용자는 상대 호스트를 특정하기 위해 ip 주소보다는 도메인 네임을 많이 사용한다. 도메인 네임은 호스트 ip 주소와 대응되는 문자열로 호스트의 특정 정보이다. (ex. www.naver.com)
- ip 주소를 전화번호에 비유하면 도메인 네임은 전화번호에 대응하는 사용자 이름과 같다.
’사용자 이름: 전화번호’ 쌍의 목록을 전화번호부에서 관리하는 것처럼 도메인 네임과 ip 주소는 네임 서버(=DNS 서버)에서 관리한다.
- IP 주소를 통해 도메인 네임을 알아내는것도 가능하다.
<br/>
<br/>

**도메인 네임 구조**

**www(3단계 도메인).example(2단계 도메인).com(최상위 도메인).(루트 도메인)**

- 도메인 네임은 점(.)을 기준으로 계층적으로 분류되며, 트리 형식으로 최상단에는 루트 도메인, 그 다음 단계인 최상위 도메인이 있으며, 계속해서 그 다음 단계의 도메인이 있는 식이다.
- 도메인 네임의 마지막 부분을 최상위 도메인이라고 하며 [www.exaple.com](http://www.exaple.com) 에서 ‘com’이다. 대표적으로는 com, net, org, kr, jp, cn, us 등이 있다.
- 최상위 도메인을 도메인 네임의 마지막이라고 생각하지만, 루트 도메인도 도메인 네임의 일부로 표기된다. 루트 도메인은 점(.)으로 표기되며, 도메인 네임의 마지막에 점이 찍힌 형태로 표기된다. 다만 일반적으로는 루트 도메인을 생략해서 표기한다.
- 최상위 도메인의 하부 도메인을 2단계 도메인이라고 부른다.
- ‘www’는 3단계 도메인이다. 이 부분을 호스트 네임이라고도 부른다.
<br/>

**⇒ 도메인 네임은 루트 도메인, 최상위 도메인, 2단계 도메인, 3단계 도메인 순으로 계층적인 형태를 이룬다.**
<br/>

**⇒ DNS는 계층적이고 분산된 도메인 네임에 대한 관리 체계이자 이를 관리하는 프로토콜이다.**
<br/>

---

<br/>

## 계층적 네임 서버

IP주소를 모르는 상태에서 도메인 네임에 대응되는 IP 주소를 알아냐는 과정을 흔히 ‘도메인 네임을 풀이한다’ 라고 표현하며 영어로는 ‘리졸빙 한다’라고도 표현한다. 

이 과정에서 다양한 네임 서버들이 사용되는데, **중요한 역할을 담당하는 네임 서버의 유형은 ‘로컬 네임 서버’, ‘루트 네임 서버’, ‘TLD(최상위 도메인)네임 서버’, ‘책임 서버’로 크게 네가지가 있다.** 
<br/>

- **로컬 네임 서버 -** 클라이언트와 맞닿아 있는 네임 서버로, 클라이언트가 도메인 네임을 통해 ip 주소를 알아내고자 할 때 가장 먼저 찾게 되는 네임서버이다. 로컬 네임 서버의 주소는 일반적으로 ISP에서 할당해주는 경우가 많은데, ISP에서 할당해 주는 주소가 아닌, 공개 DNS 서버를 이용할 수도 있다.
공개 DNS 서버의 대표적인 예로는 구글의 8.8.8.8, 8.8.8.4 가 있다.
- **루트 네임 서버 -** 루트 네임 서버는 루트 도메인을 관장하는 네임 서버로, 질의에 대해 TLD 네임 서버의 IP 주소를 반환할 수 있다.
- **TLD 네임 서버**  -  TLD를 관리하는 네임서버이다. TLD 하위 도메인 네임을 관리하는 서버 주소를 반환할 수 있다. 하위 도메인 네미을 관리하는 네임 서버는 마찬가지로 그보다 하위 도메인 네임을 관리하는 네임 서버 주소를 반환할 수 있다.
- **책임 네임 서버** - 특정 도메인 영역을 관리하는 네임 서버로, 자신이 관리하는 도메인 영역의 질의에 대해서는 다른 네임 서버에게 떠넘기지 않고 곧바로 답할 수 있는 네임 서버이다.
책임 네임 서버는 로컬 네임 서버가 마지막으로 질의하는 네임 서버이다.
<br/>
<br/>

<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSvCzzf6HsgWvEoIm2ddEStxlBBalkVV0pYFA&s" />
<br />

**재귀적 질의**

- 클라이언트가 로컬 네임 서버에게 도메인 네임을 질의하면, 로컬 네임서버는 루트 네임서버에게, 루트 네임 서버는 TLD 네임서버에게, TLD 네임서버는 다음 단계에 질의하는 과정을 반복하며 최종 응답 결과를 역순을 전달받는 방식이다.
<br />

**반복적 질의**

- 클라이언트가 로컬 네임 서버에게 IP 주소를 알고 싶은 도메인 네임을 질의하면, 로컬 네임 서버는 루트 도메인 네임 서버에게 질의해서 다음으로 질의할 네임 서버의 주소를 응답받고, 또 질의하고 서버의 주소를 응답 받는 과정을 반복하다가 최종 응답 결과를 클라이어언트에게 알려주는 방식이다.

지금까지 설명한 도메인 네임 리졸빙 과정에는 문제가 있다. 리졸빙 하기 위해 8개의 단계를 거쳐야 하는 것처럼 시간이 오래 걸리고 네트워크 상의 메시지 수가 지나치게 늘어날 수 있다는 점이다. 만약 전세계 모든 호스트가 도메인 네임 리졸빙을 위해 루트 네임 서버에 도메인 네임을 한꺼번에 질의한다면 루트 네임 서버에 과부화가 생길 것이다.
<br />

 **⇒ 그래서 실제로는 네임 서버들이 기존에 응답받은 결과를 임시로 저장했다가 추후 같은 질의에 이를 활용하는 경우가 많다. 이를 DNS 캐시라고 하며, DNS 캐시를 저장하는 용도로만 사용되는 서버도 있다.** 
<br />

DNS 캐시는 영원히 남아있는 것은 아니다. 임시로 저장된 값은 TTL이라는 값과 함께 저장되는데, 이는 캐시될 수 있는 시간을 뜻한다.
<br />

---

<br />

## 자원을 식별하는 URI

송수신하고자 하는 정보를 식별하기 위한 방식인 URI와 URI를 식별 정보 기준으로 분류한 개념인 URL, URN에 대해 알아보자.

우선 자원이란, 네트워크상의 메시지를 통해 주고받는 대상을 의미한다. 이는 HTML 파일이 될 수도 있고, 이미지나 동영상 파일이 될 수도 있고, 텍스트 파일이 될 수도 있다.  즉, 두 호스트가 네트워크를 통해 서로 정보를 주고 받을 때, 송수신하는 대상이 바로 자원이다. 

오늘날 인터넷 환경을 이루는 대부분의 통신은 HTTP를 기반으로이루어지므로, 자원이라는 용어는 HTTP 요청 메시지의 대상이라고도 표현한다. 
<br />

- URI - 자원을 식별할 수 있는 정보를 의미한다.
- URL, URN - 식별에 사용되는 정보에 따라 위치 기반 식별자인 URL과 이름 기반 식별자인 URN으로 나뉜다.
<br />
<br />


**URL**

오늘날 인터넷 환경에서 자원 식별에 더 많이 사용되는 방법은 URL과 URN 중 위치 기반 식별자인 URL을 더 많이 사용한다.

<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cih496PZ5DyEubgfYUq3Zw.png" />

1. **schema(=프로토콜)**
    
    url의 첫 부분은 schema이다. schema는 ‘자원에 접근하는 방법’을 의미한다. 일반적으로 사용할 프로토콜에 명시된다. http:// 혹은 [https://](https://로)를 사용하여 자원에 접근한다.
    
2. **authority(=도메인)**
    
    ‘호스트를 특정할 수 있는 정보’, 이를 테면 ip 주소 혹은 도메인 네임이 명시된다.
    
3. **path**
    
    ‘자원이 위치한 경로’가 명시된다. 자원의 위치는 슬래시(/)를 기준으로 계층적으로 표현되고, 최상위 경로 또한 슬래시로 표현된다. 
    
4. **query**
    
    여러 쿼리 문자열(=쿼리 파라미터)로 서버와 클라이언트가 정보를 주고 받을 수 있다.
    
5. **fragment**
    
    ‘자원의 한 조각을 가리키기 위한 정보’이다. 흔히 HTML 파일과 같은 자원에서 특정 부분을 가리키기 위해 사용된다. 
<br />
<br />

**URN**

URL의 고질적인 문제는 자원의 위치가 변한다면 URL은 유효해지지 않을 수 있어, 기존 URL로는 자원을 식별할 수 없다. 

반면 URN은 자원에 고유한 이름을 붙이는 이름 기반 식별자이기에 자원의 위치와 무관하게 자원을 식별할 수 있다는 장점이 있다. 

**urn:isbn:0451450523**

이와 같은 URN을 이용하면 프로토콜과 무관하게 자원을 식별할 수 있다. 다만 URN은 아직 URL 만큼 널리 채택된 방식은 아니기에 자원을 식별할 URI로는 URN보다는 URL이 더 많이 사용된다.
