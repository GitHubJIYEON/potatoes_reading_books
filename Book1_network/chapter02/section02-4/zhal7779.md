# chapter 02-4 스위치
스위치는 콜리전 도메인을 포트별로 나누며 전이중 모드 통신을 지원하는 데이터 링크 계층의 장비이다.  

스위치가 전달받은 신호를 원하는 포트로만 내보낼 수 있는 것은 스위치가 MAC주소를 학습 할 수 있기 때문인데, 이번 절에서는 MAC 주소 학습 기능에 대해 알아보자.
<br />
<br />
<br />

## 스위치

- 스위치는 **데이터 링크 계층**의 장비이다.
- 2**계층에서 사용한다여 L2 스위치라고도 부른다.**
- 스위치의 여러 포트에는 호스트를 연결할 수 있어, 허브와 유사하지만 허브와 달리 MAC 주소를 학습해 특정 MAC 주소를 가진 호스트에만 프레임을 전달할 수 있고, 전이중 모드의 통신을 지원한다.
- 스위치를 사용하면 **포트별로 콜리전 도메인이 나뉘고, 전이중 모드로 통신하기에 CSMA/CD 프로토콜이 필요하지 않다.**
- CSMA/CD 프로토콜이 필요하지 않아 **대기 시간이 없는 이점이 있어 오늘날까지 이더넷 네트워크 구성 시 자주 사용한다.**

**스위치의 특징**

- **MAC 주소 학습** : 스위치는 **특정 포트와 해당 포트에 연결된 호스트의 MAC 주소와의 관계를 기억하며, 이를 통해 원하는 호스트에만 프레임을 전달할 수 있는 기능**이다.
- **MAC 주소 테이블** : MAC 주소 학습을 위해 **포트와 연결된 호스트의 MAC 주소 간의 연관 관계를 메모리에 표 형태로 기억하며 MAC 주소 연관 관계를 나타내는 정보**이다.
<br />

## MAC 주소 학습

스위치가 원하는 수신지가 연결된 포트에만 프레임을 내보낼 수 있는 건 스위치의 세 가지 기능을 통해 이루어진다. 해당 기능들에 대해 알아보자.

- 호스트 A,B,C,D에서 호스트 A가 호스트 C로 프레임을 전송하는 상황을 가정해보자.

1. **플러딩**
    - 스위치가 처음 호스트 A에서 프레임을 수신하면,수신지 호스트 C가 어느 포트에 연결되어 있는지 알 지 못한다. 그래서 스위치는 마치 허브처럼 송신지 포트를 제외한 모든 포트로 프레임을 전송하는데 이를 플러딩이라고 한다.
2. **포워딩과 필터링**
    - 호스트 A가 호스트 C에게 프레임을 전송하면 스위치는 호스트 B,D가 연결된 포트로 내보내지 않도록 필터링하고, 호스트 C가 연결된 포트로 프레임을 포워딩 한다.
    - 호스트  A에서 전달받은 프레임을 어디로 내보내고 어디로 내보내지 않을지 결정하는 스위치 기능을 필터링이라고 하며, 프레임이 전송된 포트에 실제로 프레임을 내보내는 것을 포워딩이라고 한다.
3. **에이징**
    - MAC 주소 테이블에 등록된 특정 포트에서 일정 시간 동안 프레임을 전송받지 못했다면 해당 항목은 삭제되는 이를 에이징이라고 한다.
<br />

## VLAN

- VLAN은 Virtual LAN의 줄임말로, **한 대의 스위치로 가상의 LAN을 만드는 방법**이다.
- 허브는 송신지 포트를 제외한 모든 포트로 신호를 내보내기에 네트워크 상 불필요한 트래픽이 늘어나 성능의 저하로 이어진다. 하지만, 스위치를 이용해도 마찬가지이만 VLAN을 구성하면 한 대의 물리적 스위치라 해도 여러 대의 스위치가 있는 것처럼 논리적인 단위로 LAN을 구획할 수 있다.  **(⇒ 호스트의 물리적 위치와 관계없이 논리적인 LAN을 구성할 수 있다.)**
- **VLAN이 있으면 브로드캐스트 도메인도 달리지기에 서로 다른 네트워크로 간주하여,  한 VLAN에 속한 호스트가 브로드 캐스트를 하게 되면 다른 VLAN에 속한 호스트에게까지 전달되지 않는다.**

**포트 기반 VLAN**

- 가장 단순하지만 대중적인 방식이며, 스위치의 포트가 VLAN을 결정하는 방식이다.
- 사전에 특정 포트에 VLAN을 할당하고, 해당 포트에 호스트를 연결함으로써 VLAN을 포함시킬 수 있다.
- VLAN 트렁킹: 두 대 이상의 VLAN 스위치를 효율적으로 연결하여 확장하는 방법이다. 스위치 간의 통신을 위한 특별한 포트인 트렁크 포트에 VLAN 스위치를 서로 연결한다.

 **MAC 기반 VLAN** 

- 사전에 설정된 MAC 주소에 따라 VLAN이 결정되는 방식이다.
- 포트가 VLAN을 결정하는 것이 아니라 송수신하는 프레임 속 MAC 주소가 호스트가 속할 VLAN을 결정하는 방식이다.
