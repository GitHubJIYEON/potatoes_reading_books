# chapter 03-2 IP 주소

네트워크 계층의 핵심적인 역할인 IP 주소의 구조와 역할에 대해 자세히 알아보자.
<br />
<br />

## 네트워크 주소와 호스트 주소

네트워크 주소는 네트워크 ID, 네트워크 식별자 등으로 불리며, 호스트 주소는 호스트 ID, 호스트 식별자 등으로도 부른다.

네트워크 주소의 형태를 살펴보자
<br />

- **172.16.12.45** ⇒ 네트워크 주소가 16 비트, 호스트 주소가 16비트인 IP 주소의 예시이다. (하**나의 옥텟은 8 비트로 이루어져 있다.)**
- **172.16.12.45** ⇒ 네트워크의 주소가 하나의 옥텟으로 이루어져 있고, 호스트 주소가 3개의 옥텟으로 이루어진 예시이다. 한 네트워크 당 호스트 주소 할당에 24비트를 사용할 수 있어서 상대적으로 많은 호스트에 IP 주소를 할당할 수 있다.
- **172.16.12.45** ⇒ 네트워크 주소가 3개의 옥텟으로 이루어져 있고, 호스트 주소가 하나의 옥텟으로 이루어진 예시이다. 상대적으로 적은 호스트에 IP 주소를 할당할 수 있다.
  <br />

**✏️ 이처럼 IP 주소에서 네트워크 주소와 호스트 주소를 구분하는 범위는 유동적일 수 있다.**

**그렇다면 네트워크 주소와 호스트 주소의 크기는 각각 어느정도가 적당할까?**

➡️ **호스트의 주소 공간을 크게 할당하면 호스트가 할당되지 않은 다수의 IP 주소가 낭비될 수 있다. 반대로 무조건 호스트 주소 공간을 작게 할당하면 호스트가 사용할 IP 주소가 부족해질 수 있다**

. **이를 해결하기 위해 생겨난 개념이 IP주소의 클래스이다.**
<br />

## 클래스풀 주소 체계

- 클래스는 **네트워크 크기에 따라 IP 주소를 분류하는 기준**이다.
- **클래스를 이용하면 필요한 호스트 IP 개수에 따라 네트워크 크기를 가변적으로 조정해 네트워크 주소와 호스트 주소를 구획할 수 있다.**
  <br />
  <br />

## 클래스리스 주소 체계

- 클래스 풀 주소 체계를 이용하면 네트워크의 영역을 결정하고 할당 가능한 호스트의 주소 공간을 유동적으로 관리할 수 있지만, 클래스별 네트워크의 크기가 고정되어 있어 여전히 다수의 IP 주소가 낭비될 가능성이 크다는 문제가 있다.
- 그래서 클래스풀 주소 체계보다 더 유동적이고 정교하게 네트워크를 구획할 수 있는 클랙스리스 주소 체계가 등장했다.
- **이름처럼 클래스 개념없이(classless) 클래스에 구애받지 않고 네트워크 영역을 나누어서 호스트에게 ip 주소 공간을 할당하는 방식**이다.
- 오늘날 주로 사용되는 방식이다.
  <br />

**서브넷 마스크**

- 서브넷 마스크는 **클래스리스 주소 체계에서 네트워크와 호스트를 구분짓는 수단으로 이용**한다.
- 서브넷 마스크는 **IP 주소상에서 네트워크 주소는 1, 호스트 주소는0으로 표기한 비트열을 의미**한다.
- 네트워크 내의 부분적인 네트워크(=서브 네트워크)를 구분짓는(=마스크) 비트 열이다.
- 서브넷 마스크를 이용해 클래스를 원하는 크기로 더 잘게 쪼개어 사용하는 것을 서브네팅이라고 한다.
- EX) 255.0.0.0( 클래스 풀 주소, A클래스) ⇒ 11111111.0000000.00000000.00000000(클래스 리스, 서브넷 마스크)
  <br />

  **서브네팅: 비트 AND 연산**

- 서브넷 마스크를 이용해 네트워크 주소와 호스트 주소를 구분 짓는 방법은 단순하다. IP 주소와 서브넷 마스크를 비트 AND 연산을 하면 된다.
- 비트 AND 연산이란 피연산자가 모두 1인 경우에는 1, 아닌 경우에는 0이 되는 연산이다.
- 10101 + 11100 ⇒ 10100
  <br />

  ✏️ 정리하자면, 클래스리스 주소 체계는 클래스가 아니라 서브넷 마스크를 이용해 네트워크 주소와 호스트 주소를 구분하는 IP 주소 체계이다. 또한 서브넷 마스크와 IP 주소간에 비트 AND 연산을 수행하면 IP 주소내의 네트워크 주소를 알아낼 수 있다.

**서브넷 마스크 표기:CIDR 표기법**

서브넷 마스크를 표기하는 두가지가 있다.

1. **서브넷 마스크를 10진수로 직접 표기하는 방법**
   EX) IP주소 192.168.219.103과 서브넷 마스크 255.255.255.0
2. I**P주소/서브넷 마스크 상의 1의 개수 형식으로 표현하는 방법**
   EX) 192.168.219.103/24

- 여기서 두 번째 방식인 I**P주소/서브넷 마스크 상의 1의 개수 형식으로 표현하는 형식을 CIDR 표기법이라고 부른다.**
- IP 주소와 서브넷 마스크를 함께 표현할 수 있는 간단한 표기로 많이 활용된다.
  <br />
  <br />

## 공인 IP 주소와 사설 IP 주소

전세계에는 고유한 IP 주소가 있고, 고유하지 않은 IP 주소도 있다. 이전까지 설명한 내용은 고유한 IP 주소에 대한 내용이었는데 이를 공인 IP라고 부른다.
<br />

**공인 IP 주소**

- 전 세계에서 고유한 IP 주소이다.
- 네트워크 간의 통신, 인터넷을 이용할 때 사용한 IP 주소가 바로 공인 IP 주소이다.
- 공인 IP 주소는 ISP나 공인 IP 주소 할당 기관을 통해 할당 받을 수 있다.
  <br />

**사설 IP 주소와 NAT**

- 사설 네트워크에서 사용하기 위한 IP 주소이다.
- 사설 네트워크란 인터넷, 외부 네트워크에 공개되지 않은 네트워크를 의미한다.
- 우리가 사용하는 모든 네트워크 기기의 IP 주소를 전부 별도로 신청해서 할당받지는 않았는데, 그 이유는 LAN내의 많은 호스트는 사설 IP 주소를 사용하기 때문이다.
- 사설 IP 주소의 할당 주체는 일반적으로 라우터이다.
- 할당받은 사설 IP 주소는 해당 호스트가 속한 사설 네트워크 상에서만 유효한 주소라서, 얼마든지 다른 네트워크의 사설 IP 주소와 중복될 수 있다.
  <br />

**🔎 그렇다면, 사설 IP 주소를 사용하는 호스트가 외부 네트워크와 통신하려면 어떻게 해야 할까?**

**⇒ 이때 사용되는 기술이 NAT이다. NAT는 IP 주소를 즉시 변환하는 기술이다.
주로 네트워크 내부에서 사용되는 사설 IP 주소와 네트워크 외부에서 사용되는 공인 IP 주소를 변환하는 데 사용된다.**

대부분의 라우터와 가정용 공유기는 NAT 기능을 내장하고 있다.
<br />
<br />

## 정적 IP 주소와 동적 IP 주소

호스트에 IP 주소를 할당하는 방법은 두가지가 있다. 정적 할당과 동적 할당인데, 정적 할당은 수작을 통해서 이루어지고, 동적 할당은 DHCP라는 프로토콜을 통해 이루어진다.
<br />

**정적 할당**

- 정적 할당은 사용자가 호스트에 직접 고정된 IP 주소를 할당하는 방식이다.
- 수작업으로 할당된 IP 주소를 정적 IP 주소라고 부른다.
  <br />

**동적할당과 DHCP**

- IP 주소를 정적으로만 할당하다 보면 호스트의 수가 많아질 경우 관리가 곤란해질 수 있다.
- 동적 할당은 정적 할당과는 달리 IP 주소를 직접 일일이 입력하지 않아도 호스트에 IP 주소가 동적으로 할당되는 방식이다.
- 동적으로 할당된 IP 주소를 동적 IP 주소라고 부른다.
- 동적 IP 주소는 사용되지 않을 경우 회수 되고, 할당받을 때마다 다른 주소를 받을 수 있다.
- **⇒ 우리들의 스마트폰이나 노트북을 이용할 때 수동으로 IP 주소를 설정하지 않고도 인터넷을 이용할 수 있는 것은 IP 주소가 동적으로 할당되었기 때문이다. 그만틈 동적 IP 주소는 일상적으로 사용된다.**
- **IP 동적 할당에 사용되는 대표적인 프로토콜이 DHCP이다.**
- DHCP는 응용계층에 속한 프로토콜로, DHCP를 통한 IP 주소 할당은 IP 주소를 할당받고자 하는 호스트(EX. 클라이언트)와 해당 호스트에게 IP주소를 제공하는 DHCP 서버간에 메시지를 주고 받음으로써 이루어진다.
  **DHCP 서버는 클라이언트에게 할당 가능한 IP 주소 목록을 관리하다, 클라이언트가 요청할 때 IP 주소를 할당한다. 유의할 점은 DHCP로 할당 받은 IP 주소는 사용할 기간이 정해져있다. 사용 기간은 DHCP 서버에서 설정하기 나름이지만, 일반적으로 수시간에서 수일로 설정한다.**
- 사용기간이 끝난 IP 주소는 다시 DHCP 서버로 반납된다.
- 그래서 **DHCP를 통해 IP 주소를 할당 받는 것을 IP 주소를 임대한다라고 표현한다.**
